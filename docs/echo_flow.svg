<svg xmlns="http://www.w3.org/2000/svg" width="920" height="480" viewBox="0 0 920 480" role="img" aria-label="Historical Echo flow diagram">
  <style>
    .box { fill:#0b1b2b; stroke:#5aa9e6; stroke-width:1.5; rx:10; ry:10; }
    .text { fill:#dce9f5; font: 14px 'SFMono-Regular','Menlo','Consolas','Liberation Mono',monospace; }
    .arrow { stroke:#5aa9e6; stroke-width:1.5; marker-end:url(#arrowhead); fill:none; }
  </style>
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#5aa9e6" />
    </marker>
  </defs>
  <rect class="box" x="40" y="60" width="180" height="60" />
  <text class="text" x="60" y="95">Audio file (local)</text>

  <rect class="box" x="260" y="60" width="200" height="60" />
  <text class="text" x="280" y="95">Runner / automator</text>
  <text class="text" x="280" y="115">(features .features.json)</text>

  <rect class="box" x="500" y="40" width="160" height="60" />
  <text class="text" x="520" y="75">Job Queue</text>
  <text class="text" x="520" y="95">(single worker)</text>

  <rect class="box" x="700" y="40" width="180" height="80" />
  <text class="text" x="720" y="75">Echo Broker</text>
  <text class="text" x="720" y="95">(TaskConductor)</text>

  <rect class="box" x="500" y="150" width="200" height="110" />
  <text class="text" x="520" y="180">CAS data/echo_cas</text>
  <text class="text" x="520" y="200">echo/&lt;cfg&gt;/&lt;src&gt;/</text>
  <text class="text" x="520" y="220">historical_echo.json</text>
  <text class="text" x="520" y="240">manifest.json</text>
  <text class="text" x="520" y="260">index/&lt;track_id&gt;.json</text>

  <rect class="box" x="260" y="250" width="220" height="90" />
  <text class="text" x="280" y="280">App (Echo panel + History)</text>
  <text class="text" x="280" y="300">polls, fetches (ETag), caches</text>

  <rect class="box" x="40" y="260" width="200" height="80" />
  <text class="text" x="60" y="300">Cache:</text>
  <text class="text" x="60" y="320">~/Library/.../echo_cache</text>

  <line class="arrow" x1="220" y1="90" x2="260" y2="90" />
  <line class="arrow" x1="460" y1="90" x2="500" y2="70" />
  <line class="arrow" x1="660" y1="70" x2="700" y2="70" />
  <line class="arrow" x1="780" y1="120" x2="780" y2="150" />
  <line class="arrow" x1="700" y1="180" x2="660" y2="180" marker-end="url(#arrowhead)" />
  <line class="arrow" x1="560" y1="260" x2="480" y2="260" marker-end="url(#arrowhead)" />
  <line class="arrow" x1="260" y1="295" x2="240" y2="295" marker-end="url(#arrowhead)" />
  <line class="arrow" x1="440" y1="95" x2="500" y2="95" />
  <line class="arrow" x1="780" y1="120" x2="780" y2="150" />
  <line class="arrow" x1="660" y1="230" x2="700" y2="230" />
  <line class="arrow" x1="320" y1="120" x2="320" y2="150" />
</svg>
